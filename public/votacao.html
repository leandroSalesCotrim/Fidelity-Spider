<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Votação</title>

    <link rel="stylesheet" href="css/style.css">
    <link rel="shortcut icon" href="img/icones/aranha-vermelha.ico" type="image/x-icon">

</head>
<body>

    <!-- MENU -->
    <header>
        <div class="container">
            <div class="div_logo_sony">
                <img id="logo_sony" src="img/sony-logo-branca.png" draggable="false" alt="Logo Sony">
            </div>
        </div>
    </header>

    <!-- CONTEUDO -->
    <div class="div_votacao">
        <div class="container">
            
            <div class="div_img_voltar">
                <a href="dashboard.html">
                    <img src="img/icones/voltar.png" alt="">
                </a>
            </div>
            
            <div class="txt_centro">
                <h5><b><span>SpiderPoints:</span><span id="span_sp"></span></b></h5>
                <div class="titulo">
                    <h1>Escolha com sabedoria</h1>
                    <hr>
                </div>
                <p>
                    <span>Marvel's Spider-Man 2</span> já está em desenvolvimento e precisamos do seu <span>poder</span>
                    de fã para escolher o próximo vilão para importunar a vida do nosso querido amigo da 
                    vizinhança e seu aprendiz Miles Morales
                </p>
            </div>
            <div class="btn_dark_mode" >
                <img id="src_icon" onclick="dark_mode()" draggable="false" src="img/icones/dark-mode-dark.png" alt="Modo escuro">
            </div>

        
        </div>

        <div class="containerV">
            
            <div class="div_viloes" >
                <div class="card_viloes" onclick="return votarDuende()">
                    <div class="img" id="img1">
                        <div class="nome">
                            <h1>Duende macabro</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarCarnificina()">
                    <div class="img" id="img2">
                        <div class="nome">
                            <h1>Carnificina</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarChacal()">
                    <div class="img" id="img3">
                        <div class="nome">
                            <h1>Chacal</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarMorbius()">
                    <div class="img" id="img4">
                        <div class="nome">
                            <h1>Morbius</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarMysterio()">
                    <div class="img" id="img5">
                        <div class="nome">
                            <h1>Mysterio</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarKaine()">
                    <div class="img" id="img6">
                        <div class="nome">
                            <h1>Kaine</h1>
                        </div>
                    </div>
                </div>

                <div class="card_viloes" onclick="return votarKraven()">
                    <div class="img" id="img7">
                        <div class="nome">
                            <h1>Kraven</h1>
                        </div>
                    </div>
                </div>


                
            </div>
        
        </div>
    </div>
</body>
</html>
<script src="js/verificacao.js"></script>
<script src="js/main.js"></script>
<script>
    sp = Number(sessionStorage.SPIDERPOINTS_USUARIO);
    id_usuario = sessionStorage.ID_USUARIO;
    span_sp.innerHTML=sp;
    var vilao_escolhido;

    function votarDuende(){
        vilao_escolhido = "Duende Macabro";
        return votar();
    }
    function votarCarnificina(){
        vilao_escolhido = "Carnificina";
        return votar();
    }
    function votarChacal(){
        vilao_escolhido = "Chacal";
        return votar();
    }
    function votarMorbius(){
        vilao_escolhido = "Morbius";
        return votar();
    }
    function votarMysterio(){
        vilao_escolhido = "Mysterio";
        return votar();
    }
    function votarKaine(){
        vilao_escolhido = "Kaine";
        return votar();
    }
    function votarKraven(){
        vilao_escolhido = "Kraven";
        return votar();
    }

    function votar() {
        sp = sp + 1000;
        
        var corpo = {
            id_usuario: id_usuario,
            vilao: vilao_escolhido,
            spider_points: sp
        }

        fetch(`/usuarios/votar`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(corpo)
            
        }).then(function (resposta) {
        
            console.log("resposta: ", resposta);
        
            if (resposta.ok) {
                window.alert("Obrigado por votar,\ncomo recompensa você ganhou 1000 SpiderPoints por isto!");
                sessionStorage.SPIDERPOINTS_USUARIO = sp;
                //CHAMAR FUNÇÂO DE MOSTRAR AS PORCENTAGEM DE VOTO
            } else {
                throw ("Houve um erro ao tentar votar1!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
        
    }

</script>
